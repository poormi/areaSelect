!function($,w){"use strict";function _init(e,t){function a(e,t,n){var s=$("<span>"),o=$("<li>"),i=['<a href="javascript:"><span>',n.name,'</span><i class="triangle"> </i>',"</a>"];s.html(n.name),s.data("code",n.code),e.P(s),t.length&&(o.data("code",n.code),o.data("index",t.C().length),t.P(o.P(i.join("")))),n.data&&n.data.length&&(e.P(defaults.split),a(e,t,n.data[0]))}function n(e,t){var a=$.create("ul");a.data("index",e.C().length),$.each(t,function(e,t){var n=$.create("li"),s=['<a href="javascript:">',t.name,"</a>"];n.P(s.join("")),0===e&&n.A("selected"),n.data("code",t.code),a.P(n)}),e.P(a),t[0].data&&t[0].data.length&&n(e,t[0].data)}var s=$.create("div","select-data"),o=t;if(e.P(s),o.length){var i=$.create("div","select-wrap clear"),r=[];o[0].data&&(r=$.create("ul","select-tabs"),i.P(r)),e.P(i);var d=o[0];a(s,r,d),r.length&&r.C().eq(0).A("active");var l=$.create("div","select-content clear");i.P(l),n(l,t),l.C().eq(0).show()}s.P('<i class="triangle"></i>')}function _request(selector){var dtd=$.Deferred(),options=this.options;return $.get(options.url).done(function(data){"string"==typeof data&&(data=eval("("+data+")")),void 0==data.flag||"true"!=data.flag&&data.flag!==!0?console.log("Request error:please check the network and make sure the url is correct."):(options.data=data.data,_init(selector,options.data)),dtd.resolve()}),dtd.promise()}function _bindEvents(e){function t(e){var t=$("."+r+"."+_sClass),a=$(this).parent();a.hasClass(r)?a.R(r):(t.length&&t.R(r),a.A(r)),e.stopPropagation()}function a(e){c.find("li.active").R("active");var t=$(this).data("index"),a=$(this).parent().next().find("ul");$(this).toggleClass("active"),a.hide(),a.eq(t).show(),e.stopPropagation()}function n(e){var t=$(this).parent(),a=t.data("index"),n=o.selectedCodes.length,s=$(this).data("code");if(t.C().R("selected"),$(this).A("selected"),n>a)o.selectedCodes[a]=s;else{if(a>n)for(var i=a;i>n;i--)o.selectedCodes.push(null);o.selectedCodes.push(s)}if(o.options.onSelect(s),1==c.length)l.eq(0).find("span").text($(this).text());else{var r=t.parent().prev().C().eq(a);if(r.find("span").text($(this).text()),r.next().length)r.next().mousedown();else{var d=$.trim(c.eq(0).text()).split(" ");$.each(l.eq(0).find("span"),function(e,t){$(t).text(d[e])})}}t.next().length||(l.mousedown(),o.options.onClose(o.selectedCodes)),e.stopPropagation()}function s(t){var a=t.srcElement||t.target;e.hasClass(r)&&a!=e[0]&&e.R(r)}var o=this,i="mousedown",r="expand",l=e.C();_eventHandler(l.eq(0),i,t);var c=l.eq(1).C(),u=c.eq(0).find("li");1==c.length&&(a=n),_eventHandler(u,i,a);var h=c.eq(1).find("li");_eventHandler(h,i,n),_eventHandler(l.eq(1),i,function(e){e.stopPropagation()}),_eventHandler($(d),i,s)}function _eventHandler(e,t,a){e.on(t,a)}var defaults={split:"/",url:"",data:[],onLoad:function(){},onSelect:function(){},onClose:function(){}},areaSelect=function(e,t){return this.init.call(this,e,t),this},_sClass="area-select",d=document,jq=$.fn;jq.extend({A:jq.addClass,C:jq.children,R:jq.removeClass,P:jq.append}),areaSelect.prototype={constructor:areaSelect,init:function(e,t){var a=this,n=a.options=$.extend({},defaults,t);return a.selector=e,a.selectedCodes=[],n.data.length?(_init(e,n.data),_bindEvents.call(a,e),n.onLoad()):""!==$.trim(n.url)?$.when(_request.call(a,e)).done(function(){_bindEvents.call(a,e),n.onLoad()}):console.log("Data error: there is no data here."),a},getSelectedCodes:function(){return this.selectedCodes}},$.fn.areaSelect=function(){var e=this,t=Array.prototype.slice.call(arguments);return e.A(_sClass),new areaSelect(e,t[0])},$.create=function(e,t){return $(d.createElement(e)).A(t)}}(jQuery,window);